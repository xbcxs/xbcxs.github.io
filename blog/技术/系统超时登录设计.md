
# 系统超时登录设计与

## 需求分析

当用户登录系统长时间未操作，超过登录超时间进行操作时提示登录系统，登录后能直接回到目标页，继续进行相关工作。

- 提示统一
- 操作便捷：提示登录后能直接跳回目标页面

## 场景分析
### 用户登录超时逻辑
1. 用户登录系统，后台系统记录用户登录相关信息。
2. 后台系统根据系统超时配置将过期登录用户从后台已登录用户集合中删除，用户在登录失效前触发相关操作，后台会对用户登录续期。
3. 当用户超时后，后续再进行客户端操作将提示用户登录超时。

### 用户操作请求分类：
- 静态资源请求；
- 页面HTTP GET请求；
- 页面Ajax HTTP POST请求；

## 设计与实现

1. 前端请求经过网关（权鉴拦截器）。
2. 网关分析请求类型，根据不同请求类型做出相应处理。
- 由于系统涉及大量静态资源请求，因此对静态资源默认不拦截，如果有特殊需求可以设置特殊拦截名单。
- 对于页面HTTP GET请求，拦截验超时后由网关统一处理，将被拦截的请求地址作为参数重定向到跳转超时重新登录页面。登录页面登录后再重定向到上一步传过来的参数地址（被登录超时拦截下来的目标地址）
- 对于页面Ajax HTTP POST请求，需要前端在请求里增加约定参数。用于网关验证登录超时，根据该参数标志响应登录超码给前端。在前端ajax取返回参数的事件里,根据该标识对当前页面进行遮罩，在遮罩层上弹起登录框。当用户登录后刷新当前页面。该场景需要前端对前端框架AJAX进行统一请求前事件和返回参数的事件进行统一扩展改造。

##